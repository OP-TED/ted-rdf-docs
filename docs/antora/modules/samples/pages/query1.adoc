:doctitle: Find the highest value contract award published on a particular date
:doccode: ODS-SAMP-02
:author: NPJ
:authoremail: nicole-anne.paterson-jones@ext.ec.europa.eu
:docdate: July 2024


== The Scenario
* Presentation of the scenario
* Business value
* A short discussion of the the extent to which the current data offering can assist/ Understanding data limitations
* Refining the question

== The information
* Identifying the information to be returned
* Using the eProcurement ontology (glossary and conceptual model) to identify the classes and class relationships that can be used to find the information
* Constructing the query

== The Query

TIP: Use the copy icon on the top right of the source block to copy the query to the clipboard

[source]
----
PREFIX epo: <http://data.europa.eu/a4g/ontology#>
PREFIX org: <http://www.w3.org/ns/org#>
PREFIX cccev: <http://data.europa.eu/m8g/>
SELECT
?LotURI
?WinnerLegalName
?WinnerCountryCode
?LotAwardedValue
?LotAwardedValueCurrency
WHERE {
    VALUES ?NoticePublicationDate {
        "20230921"
    }
    FILTER(LANG(?WinnerLegalName) = 'en')
    ?Notice epo:hasPublicationDate ?NoticePublicationDate ;
            epo:refersToLot ?LotURI .
    ?LotAwardOutcome epo:describesLot ?LotURI ;
                     epo:hasAwardedValue ?MonetaryValue ;
                     epo:comprisesTenderAwardOutcome ?TenderAwardOutcome.
    ?TenderAwardOutcome a epo:TenderAwardOutcome;
                        epo:indicatesAwardOfLotToWinner / epo:playedBy ?Winner.
    ?Winner a org:Organization;
            epo:hasLegalName ?WinnerLegalName .
    OPTIONAL {
        ?Winner cccev:registeredAddress / epo:hasCountryCode ?WinnerCountryCode.
    }
    ?MonetaryValue a epo:MonetaryValue;
                   epo:hasAmountValue ?LotAwardedValue;
                   epo:hasCurrency ?LotAwardedValueCurrency .
}
ORDER BY DESC(?LotAwardedValue)
LIMIT 1
----

* Running the Query (link to EndPoint)
* Examining and refining the query results

include::ROOT:partial$feedback.adoc[]