= Using procurement data

This page explains how to use procurement data accessed from *Cellar* with Microsoft Excel. There are different ways to access TED notices in CELLAR
and use the data. The methods described below work with TED notice and other type of semantic assets.

The users shall use TED specific SPARQL queries to fetch needed data.

== Microsoft Excel

This chapter shows an example of getting data from Cellar using Microsoft Excel. You can download https://github.com/OP-TED/ted-rdf-docs/blob/main/spreadsheets/sample_application.xlsx[this sample Ms Excel File], or follow the tutorial below.

[arabic]
. Prepare the link with necessary query:

* Access:
https://publications.europa.eu/webapi/rdf/sparql[[.underline]#https://publications.europa.eu/webapi/rdf/sparql#]

* Insert query

Example query:
[source, sparql]
PREFIX cdm: <http://publications.europa.eu/ontology/cdm#>
PREFIX cmr: <http://publications.europa.eu/ontology/cdm/cmr#>
prefix purl: <http://purl.org/dc/elements/1.1/>
SELECT * WHERE {
    ?work cdm:work_date_document ?dd.
    ?work owl:sameAs ?psi.
    ?work cmr:creationDate ?creation.
    ?work cmr:lastModificationDate ?lastmodif .
    ?expr cdm:expression_belongs_to_work ?work .
    ?expr cdm:expression_uses_language ?lang .
    ?manif cdm:manifestation_manifests_expression ?expr .
    ?manif cdm:manifestation_type ?format.
    ?item cdm:item_belongs_to_manifestation ?manif.
    FILTER (str(?lastmodif) > '2023-08-09' && str(?lastmodif) < '2023-08-11')
    FILTER (regex(str(?psi), '/ted/'))
} order by desc(?lastmodif)

* Push the “Run Query” button to test that the query is correct.

image:user_manual/ms_excell/image1.png[image,width=607,height=466]

* Copy entire link of the result

image:user_manual/ms_excell/image2.png[image,width=801,height=281]

[arabic, start=2]
. Access result table via Excel:

* Click on Data -> From Web button


image:user_manual/ms_excell/image3.png[image,width=601,height=264]

* In appeared window insert result link then press OK:

image:user_manual/ms_excell/image4.png[image,width=601,height=320]

* In result window select necessary table, press Connect:

image:user_manual/ms_excell/image5.png[image,width=601,height=464]

* In result window select necessary table, press load:

image:user_manual/ms_excell/image6.png[image,width=601,height=464]

== How to download a Notice file?
To download a notice file, it is necessary to use the previous query, and in the result that appears, to access the link of the object linked with the object item.

image:user_manual/ms_excell/image7.png[image,width=801,height=464]
