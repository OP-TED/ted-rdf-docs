:doctitle: MS Excel
:doccode: sws-main-prod-023
:author: NPJ
:authoremail: nicole-anne.paterson-jones@ext.ec.europa.eu
:docdate: October 2023


This page explains how to use procurement data accessed from *Cellar* with Microsoft Excel. A sample Excel file is provided for download that contains macros that connect to the endpoint, run the query, and return the results from within the file.

////
There are different ways to access TED notices in CELLAR 
and use the data. The methods described below work with TED notices and other type of semantic assets.
////

== Using the Microsoft Excel sample file 

 The spreadsheet can be downloaded from https://github.com/OP-TED/ted-rdf-docs/blob/main/spreadsheets/sample_application.xlsm[here].

In the file are the following sheets:

** Query - sheet for entering the SPARQL query
** Result Query - sheet containing result table after querying
** Sample analysis -  analysis of results (charts, ect) using data from Result Query sheet

The following steps shows how to insert or update data using the sample app:

. When opening the downloaded spreadsheet, and depending on the version of MS Excel used, a pop-up box might appear asking you to choose a privacy level. Set it to ignore privacy level checks: tick the checkbox to ignore Privacy Levels and then click "Save".

.Change privacy levels
image::user_manual/ms_excell/image11.png[image,width=507,height=466]

[arabic, start=2]
. In the opened Excel spreadsheet, paste the SPARQL query into the "Query" sheet.

.Example SPARQL Query
image::user_manual/ms_excell/image8.png[image,width=507,height=466]

NOTE: After updating the query cell, the macros script will automatically trigger data updates. If the SPARQL query returns an empty result, MS Excel will create an error such as below

image::user_manual/ms_excell/image12.png[image,width=507,height=466]

[arabic, start=3]
. After data is updated, in the "Response Query" sheet you will find the updated table.

.Query result table
image::user_manual/ms_excell/image9.png[image,width=907,height=466]

[arabic, start=4]
. In the "Sample analysis" sheet you can find an example of analysis of the query result. Press "Update tables" button to update the Pivot tables and plots.

.Sample analysis
image::user_manual/ms_excell/image10.png[image,width=807,height=166]
{nbsp}

include::partial$feedback.adoc[]

